nohup: ignoring input
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Aggregating events for cardiac arrest, with 15 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Unique items in LABEVENTS with cardiac arrest: 511 items
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
For outputevents:
88 items were included from 1153 unique items.
For labevents
149 items were included from 511 unique items.
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 329.38577032089233 seconds
Input dimensions: 1193 patients x 72 hours x 88 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_15bin
Starting Aggregation for Lab Events for 1193 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/utils.py:137: DtypeWarning: Columns (5) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:544: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Labevents Aggregation done in 256.0057740211487 seconds
Input dimensions: 1193 patients x 72 hours x 149 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_15bin
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Unique items in LABEVENTS with cardiac arrest: 540 items
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Unique Columns in df_output_patient
['ROW_ID', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
Unique Columns in df_lab_patient
['ROW_ID_x', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID_y', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 324.9080400466919 seconds
Input dimensions: 1193 patients x 72 hours x 88 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_15bin_neg
Starting Aggregation for Lab Events for 1193 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Labevents Aggregation done in 255.40316081047058 seconds
Input dimensions: 1193 patients x 72 hours x 149 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_15bin_neg
aggregate_events took 1225.9474411010742
Loaded input_cardiac arrest_lab_15bin.npy
shape: (1193, 72, 149)
Loaded input_cardiac arrest_output_15bin.npy
shape: (1193, 72, 88)
Loaded input_cardiac arrest_lab_15bin_neg.npy
shape: (1193, 72, 149)
Loaded input_cardiac arrest_output_15bin_neg.npy
shape: (1193, 72, 88)
combined length: 1193
combined_neg length: 1193
data_train shape: (1908, 72, 237)
labels_train shape: (1908, 1)
data_test shape: (478, 72, 237)
labels_test shape: (478, 1)
Aggregating events for cardiac arrest, with 20 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Unique items in LABEVENTS with cardiac arrest: 511 items
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
For outputevents:
77 items were included from 1153 unique items.
For labevents
134 items were included from 511 unique items.
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 286.4296271800995 seconds
Input dimensions: 1193 patients x 72 hours x 77 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_20bin
Starting Aggregation for Lab Events for 1193 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/utils.py:137: DtypeWarning: Columns (5) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:544: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Labevents Aggregation done in 229.28031396865845 seconds
Input dimensions: 1193 patients x 72 hours x 134 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_20bin
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Unique items in LABEVENTS with cardiac arrest: 540 items
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Unique Columns in df_output_patient
['ROW_ID', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
Unique Columns in df_lab_patient
['ROW_ID_x', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID_y', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 285.60677695274353 seconds
Input dimensions: 1193 patients x 72 hours x 77 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_20bin_neg
Starting Aggregation for Lab Events for 1193 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Labevents Aggregation done in 228.87194991111755 seconds
Input dimensions: 1193 patients x 72 hours x 134 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_20bin_neg
aggregate_events took 1089.6684186458588
Loaded input_cardiac arrest_lab_20bin.npy
shape: (1193, 72, 134)
Loaded input_cardiac arrest_output_20bin.npy
shape: (1193, 72, 77)
Loaded input_cardiac arrest_lab_20bin_neg.npy
shape: (1193, 72, 134)
Loaded input_cardiac arrest_output_20bin_neg.npy
shape: (1193, 72, 77)
combined length: 1193
combined_neg length: 1193
data_train shape: (1908, 72, 211)
labels_train shape: (1908, 1)
data_test shape: (478, 72, 211)
labels_test shape: (478, 1)
Aggregating events for cardiac arrest, with 25 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Unique items in LABEVENTS with cardiac arrest: 511 items
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
For outputevents:
60 items were included from 1153 unique items.
For labevents
129 items were included from 511 unique items.
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 225.50782418251038 seconds
Input dimensions: 1193 patients x 72 hours x 60 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_25bin
Starting Aggregation for Lab Events for 1193 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/utils.py:137: DtypeWarning: Columns (5) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:544: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Labevents Aggregation done in 223.83979272842407 seconds
Input dimensions: 1193 patients x 72 hours x 129 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_25bin
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Unique items in LABEVENTS with cardiac arrest: 540 items
[50863 50868 50878 50882 50885 50893 50902 50912 50931 50960 50970 50971
 50983 51002 51006 51137 51146 51200 51221 51222 51233 51244 51246 51248
 51249 51250 51252 51254 51256 51265 51267 51277 51278 51279 51301 51275
 50800 50802 50804 50808 50812 50813 50816 50817 50818 50819 50820 50821
 50826 50827 50828 50810 50811 50825 50910 50911 51237 51274 50861 50862
 50867 50956 51007 51214 50809 50822 50801 50823 50824 50803 50806 50908
 50964 51143 51144 51151 51251 51255 51268 51463 51464 51466 51476 51478
 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516 51518
 51519 50979 51087 51093 50993 50994 51462 51505 51009 51497 50883 50884
 51199 51474 50933 50935 50866 51257 51266 50887 51296 51482 51512 51147
 50954 51003 51283 50815 51069 51070 51078 51082 51099 51100 51102 51501
 50890 50891 50918 50924 50925 50952 50953 50998 51010 50946 50965 50941
 51243 50889 50967 51104 51067 51094 51108 50879 50880 50999 51138 51139
 51071 51074 51075 51079 51090 51092 51116 51117 51118 51120 51123 51125
 51127 51128 51427 51428 51431 51434 51436 51438 51439 50841 50842 50851
 51429 51288 50920 50968 50969 50937 50940 50942 50943 51197 51260 51097
 50899 51008 50852 51385 51235 51297 50909 50915 51196 51213 51053 51054
 51059 51446 51447 51448 51450 51453 51455 51457 51458 50919 51145 50872
 50976 50873 50917 50903 50904 50905 50907 51000 51479 50995 51105 51240
 51287 50929 50856 50922 50981 51469 51115 50938 51494 51515 51422 51292
 51302 51499 51198 51014 51015 51018 51344 51351 51354 51355 51357 51360
 51362 51363 51218 51262 51294 51264 50944 51513 51076 51095 50939 50962
 50972 51089 50930 51441 51452 50978 50857 50927 50963 51259 51152 51164
 51167 51168 51172 51176 51183 51184 51192 51215 51230 51234 51238 51239
 50990 51091 51034 51043 51419 51232 51489 50949 50950 50951 51028 51269
 51088 51046 51047 51060 51444 50835 50836 50843 50849 51114 51150 51077
 51001 51245 51300 50814 50886 51131 51133 51180 51433 50974 51261 51231
 51103 51025 51026 51035 51517 50854 50855 51134 51224 51226 51227 51290
 50831 51523 51375 51379 51382 51383 51384 51370 51372 51373 51374 51376
 50832 51445 50829 50830 50805 51481 50864 51027 51030 51032 51039 51041
 51042 51045 51086 51098 51510 51011 51284 51017 51352 50948 50975 50900
 50913 51347 51216 51229 50926 50958 50973 51062 51064 51065 51241 50895
 50896 51005 50966 51085 51495 50906 51204 51205 50945 51236 50877 50991
 50914 50986 51343 51348 51206 51298 51299 51507 51263 51148 51080 51081
 51101 51106 51109 50892 51149 50997 51339 51342 51271 51140 51044 51440
 51181 51194 50928 51130 51132 51038 51386 51052 50871 50850 50992 51063
 50881 51202 51203 51208 51460 50838 50980 51110 51083 51369 51442 51451
 51456 51051 50874 51303 51305 51306 51307 51309 51310 51313 51314 51315
 51319 51320 51321 51323 51324 51325 51326 51328 51331 51332 51333 51334
 51336 51337 51338 51340 51341 51424 51388 51398 51399 51400 51402 51404
 51411 51412 51416 51420 51423 51425 51426 51392 51406 51435 50932 51397
 51408 51418 51280 51281 51454 51037 51461 51228 51049 51465 51068 51270
 51272 51273 51407 51413 51050 51057 51058 50957 50865 51124 50876 51061
 51111 50853 51135 51142 51195 51201 51286 51471 51467 51219 51122 51358
 51361 50988 51449 50898 51490 51276 51174 51175 51185 51186 51470 50901]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Unique Columns in df_output_patient
['ROW_ID', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
Unique Columns in df_lab_patient
['ROW_ID_x', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID_y', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
Number of common patients: 1193
df1_common length: 1193
df2_common length: 1193
Starting Aggregation for Output Events for 1193 patients
Outputevents Aggregation done in 225.74750065803528 seconds
Input dimensions: 1193 patients x 72 hours x 60 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_output_25bin_neg
Starting Aggregation for Lab Events for 1193 patients
Labevents Aggregation done in 223.33048701286316 seconds
Input dimensions: 1193 patients x 72 hours x 129 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_cardiac arrest_lab_25bin_neg
aggregate_events took 957.3080825805664
Loaded input_cardiac arrest_lab_25bin.npy
shape: (1193, 72, 129)
Loaded input_cardiac arrest_output_25bin.npy
shape: (1193, 72, 60)
Loaded input_cardiac arrest_lab_25bin_neg.npy
shape: (1193, 72, 129)
Loaded input_cardiac arrest_output_25bin_neg.npy
shape: (1193, 72, 60)
combined length: 1193
combined_neg length: 1193
data_train shape: (1908, 72, 189)
labels_train shape: (1908, 1)
data_test shape: (478, 72, 189)
labels_test shape: (478, 1)
Aggregating events for sepsis, with 15 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with sepsis: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[50809 50818 50820 50821 50822 50800 50802 50804 50808 51221 50882 50893
 50902 50912 50960 50970 50983 51006 51222 51237 51248 51249 51250 51265
 51274 51275 51277 51279 51301 50868 50931 50971 50817 50861 50862 50863
 50867 50878 50885 50910 50911 50954 50956 51003 51463 51464 51466 51476
 51478 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516
 51519 50903 50904 50905 50907 50993 51000 50810 50811 50812 50824 50828
 50806 51134 51137 51143 51144 51146 51200 51233 51244 51246 51251 51252
 51254 51255 51256 51257 51267 51268 51294 50967 50908 50883 50884 51283
 51266 50813 50816 50819 50826 50827 51069 51070 51082 51087 50852 50924
 50925 50952 50953 50998 51010 50940 50942 50943 50866 51099 51102 51104
 50927 51260 51287 51292 51296 50979 50825 51002 50986 51214 51071 51074
 51075 51079 51090 51092 51216 50995 50887 50801 50823 50909 51009 50930
 50976 51046 51053 51054 51059 51446 51448 51450 51455 51457 51458 51288
 51482 50906 51512 51151 50920 51462 50854 50855 50889 50879 50880 50999
 50935 51007 50957 50964 51078 51097 51100 51196 50835 50836 50838 50841
 50842 50843 50849 51110 51114 51116 51120 51125 51127 51128 51213 50803
 50857 51014 51018 51351 51355 51360 51362 51363 51479 51076 51093 50917
 51469 51474 51240 51278 50919 50815 50895 50896 50937 50941 50974 50994
 51005 51080 51081 51094 51101 51106 51108 51109 50922 51264 50929 51103
 51086 51098 50975 51095 51105 50918 50948 50949 50950 50951 51481 50814
 51284 51501 51513 51008 51523 51138 51139 51297 50856 50981 51427 51428
 51431 51436 51438 51439 51387 51347 51352 50963 51218 51001 50933 51147
 50978 51518 51444 51373 51375 51379 51382 51383 51384 51117 51118 51269
 50990 51343 50891 50873 50966 50968 51197 50945 51145 50845 50864 50900
 50939 50969 51358 50938 50944 51429 51442 51447 51453 50831 51047 51052
 51441 50805 51032 51434 50890 51259 51152 51160 51164 51167 51168 51172
 51176 51180 51183 51184 51192 51194 51215 51230 51238 51239 51262 51203
 51206 51209 51210 51235 51243 51298 51299 50962 50972 51115 51112 51016
 51261 50872 50965 51123 51025 51026 51034 51035 51043 51344 51130 51131
 51132 51133 51181 51245 51300 50874 50876 51357 51370 51372 51374 51247
 51232 51497 50898 51419 51148 51199 51505 51499 51067 51068 51231 51077
 50871 51424 51345 51229 50914 50899 50829 50850 51122 51385 51084 51088
 51027 51030 51039 51041 51042 50877 51040 51045 51072 51073 51140 50886
 51465 51517 50946 50980 50901 51091 51386 51432 51263 51445 51085 51089
 50928 51489 51291 51388 51398 51400 51402 51404 51411 51412 51420 51423
 51425 51426 50830 50832 51460 51507 51044 51028 51440 51212 50892 51061
 51062 51063 51064 51065 51503 50915 50973 51510 51408 51418 50997 51422
 51015 51494 50921 50926 50958 51051 51060 51376 51515 51467 51198 50913
 51224 51226 51227 51285 51048 51050 51057 51058 51302 51369 51234 51303
 51313 51315 51317 51319 51325 51326 51335 51337 51340 51341 51342 51017
 51111 51452 51149 51377 51228 51270 51271 51272 51273 51471 51511 51359
 51241 51353 51339 51276 51470 51202 51461 51205 50977 50991 51496 51223
 51225 51258 51399 51407 51416 51354 51356 51348 51150 50988 51454 51397
 50932 50996 51204 50853 51350 50992 51162 51163 51174 51175 50865 50881
 51305 51306 51307 51309 51310 51314 51320 51321 51323 51324 51328 51331
 51332 51333 51334 51336 51338 51495 51219 51236 51529 51207 51049 51393
 51413 51038 50961 51396 51414 51208 51480 51389 51391 51401 51403]
Unique items in LABEVENTS with sepsis: 563 items
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
[50809 50818 50820 50821 50822 50800 50802 50804 50808 51221 50882 50893
 50902 50912 50960 50970 50983 51006 51222 51237 51248 51249 51250 51265
 51274 51275 51277 51279 51301 50868 50931 50971 50817 50861 50862 50863
 50867 50878 50885 50910 50911 50954 50956 51003 51463 51464 51466 51476
 51478 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516
 51519 50903 50904 50905 50907 50993 51000 50810 50811 50812 50824 50828
 50806 51134 51137 51143 51144 51146 51200 51233 51244 51246 51251 51252
 51254 51255 51256 51257 51267 51268 51294 50967 50908 50883 50884 51283
 51266 50813 50816 50819 50826 50827 51069 51070 51082 51087 50852 50924
 50925 50952 50953 50998 51010 50940 50942 50943 50866 51099 51102 51104
 50927 51260 51287 51292 51296 50979 50825 51002 50986 51214 51071 51074
 51075 51079 51090 51092 51216 50995 50887 50801 50823 50909 51009 50930
 50976 51046 51053 51054 51059 51446 51448 51450 51455 51457 51458 51288
 51482 50906 51512 51151 50920 51462 50854 50855 50889 50879 50880 50999
 50935 51007 50957 50964 51078 51097 51100 51196 50835 50836 50838 50841
 50842 50843 50849 51110 51114 51116 51120 51125 51127 51128 51213 50803
 50857 51014 51018 51351 51355 51360 51362 51363 51479 51076 51093 50917
 51469 51474 51240 51278 50919 50815 50895 50896 50937 50941 50974 50994
 51005 51080 51081 51094 51101 51106 51108 51109 50922 51264 50929 51103
 51086 51098 50975 51095 51105 50918 50948 50949 50950 50951 51481 50814
 51284 51501 51513 51008 51523 51138 51139 51297 50856 50981 51427 51428
 51431 51436 51438 51439 51387 51347 51352 50963 51218 51001 50933 51147
 50978 51518 51444 51373 51375 51379 51382 51383 51384 51117 51118 51269
 50990 51343 50891 50873 50966 50968 51197 50945 51145 50845 50864 50900
 50939 50969 51358 50938 50944 51429 51442 51447 51453 50831 51047 51052
 51441 50805 51032 51434 50890 51259 51152 51160 51164 51167 51168 51172
 51176 51180 51183 51184 51192 51194 51215 51230 51238 51239 51262 51203
 51206 51209 51210 51235 51243 51298 51299 50962 50972 51115 51112 51016
 51261 50872 50965 51123 51025 51026 51034 51035 51043 51344 51130 51131
 51132 51133 51181 51245 51300 50874 50876 51357 51370 51372 51374 51247
 51232 51497 50898 51419 51148 51199 51505 51499 51067 51068 51231 51077
 50871 51424 51345 51229 50914 50899 50829 50850 51122 51385 51084 51088
 51027 51030 51039 51041 51042 50877 51040 51045 51072 51073 51140 50886
 51465 51517 50946 50980 50901 51091 51386 51432 51263 51445 51085 51089
 50928 51489 51291 51388 51398 51400 51402 51404 51411 51412 51420 51423
 51425 51426 50830 50832 51460 51507 51044 51028 51440 51212 50892 51061
 51062 51063 51064 51065 51503 50915 50973 51510 51408 51418 50997 51422
 51015 51494 50921 50926 50958 51051 51060 51376 51515 51467 51198 50913
 51224 51226 51227 51285 51048 51050 51057 51058 51302 51369 51234 51303
 51313 51315 51317 51319 51325 51326 51335 51337 51340 51341 51342 51017
 51111 51452 51149 51377 51228 51270 51271 51272 51273 51471 51511 51359
 51241 51353 51339 51276 51470 51202 51461 51205 50977 50991 51496 51223
 51225 51258 51399 51407 51416 51354 51356 51348 51150 50988 51454 51397
 50932 50996 51204 50853 51350 50992 51162 51163 51174 51175 50865 50881
 51305 51306 51307 51309 51310 51314 51320 51321 51323 51324 51328 51331
 51332 51333 51334 51336 51338 51495 51219 51236 51529 51207 51049 51393
 51413 51038 50961 51396 51414 51208 51480 51389 51391 51401 51403]
Number of unique patients with sepsis: 4226
Number of output events with sepsis: 374773
Number of unique patients with sepsis: 4497
Number of lab events with sepsis: 1118623
For outputevents:
113 items were included from 1153 unique items.
For labevents
201 items were included from 563 unique items.
Number of common patients: 4156
df1_common length: 4156
df2_common length: 4156
Starting Aggregation for Output Events for 4156 patients
Outputevents Aggregation done in 1410.6701185703278 seconds
Input dimensions: 4156 patients x 72 hours x 113 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_output_15bin
Starting Aggregation for Lab Events for 4156 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/utils.py:137: DtypeWarning: Columns (5,7,22) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
Labevents Aggregation done in 1166.3393936157227 seconds
Input dimensions: 4156 patients x 72 hours x 201 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_lab_15bin
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with sepsis: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50993 50979 51240 50806 50822 50824
 50826 50828 51003 50819 51007 51218 51071 51074 51075 51079 51087 51090
 51092 50924 50938 50952 50953 50998 51283 50929 51103 51082 51093 51100
 51104 50883 50884 51014 51018 51351 51355 51360 51362 51363 50803 51257
 51284 51292 51294 51151 51259 51347 51148 50856 50879 50880 50922 50964
 50981 50999 50995 51001 50937 50939 50920 51482 51512 50889 50915 50935
 51497 51501 50933 51053 51054 51059 51446 51447 51448 51450 51455 51457
 51458 51213 51196 51078 51097 51236 50925 51010 51479 51352 50903 50904
 50905 50907 50873 50927 50980 51474 51523 51076 51094 51108 50835 50838
 51110 51111 51116 51117 51120 51125 51127 51128 50930 50976 50843 50849
 51118 50836 50841 50842 50866 51288 50967 51269 51026 51032 51038 51461
 50919 51099 51102 50831 51386 51427 51428 51431 51434 51436 51438 51439
 51069 51070 50944 50814 51147 51085 51130 51131 51132 51133 51176 51180
 51181 51194 51245 51300 50917 50914 51002 50986 50978 50968 50969 50874
 50975 50966 50965 50994 50895 50896 51005 51091 51088 51095 50974 50913
 50890 50891 51518 50963 51114 51469 50857 51197 51205 51206 51232 50946
 50949 50950 50951 50844 51134 51028 50871 50876 50918 51344 51419 51429
 51086 51098 50948 50852 51216 51138 51139 51243 51343 51357 51198 51261
 51264 51235 51297 51105 50805 51369 51373 51375 51379 51382 51384 51046
 51444 51077 51515 51385 51015 51383 50997 50881 51067 51068 51080 51081
 51101 51106 51109 51503 51063 51505 50872 51387 51123 51008 51513 51089
 51422 51445 51302 51499 51229 51047 51052 51228 51517 51060 51231 51234
 51424 50854 50855 51460 51441 51440 51453 50906 51150 51036 51051 51073
 51072 51204 51471 51262 51494 51376 51452 51034 51043 51358 51025 51035
 50892 50899 51278 50962 50972 51451 51489 51348 51199 51481 51224 51226
 51227 51290 51442 51084 51136 50957 50928 50829 51263 51291 51276 50830
 51112 51366 51378 51381 51030 51041 51042 51061 51062 51064 51065 51271
 51454 51430 51433 51027 51045 51022 50996 51500 51017 51495 50886 51122
 51124 51289 51140 51272 51273 51368 51365 50932 51377 51380 50945 51459
 50877 50991 50851 51339 51342 50848 51247 50837 50847 51115 51113 51152
 51164 51167 51168 51172 51183 51184 51192 51215 51230 51238 51239 51353
 51303 51309 51313 51314 51315 51317 51319 51321 51325 51326 51332 51335
 51337 51338 51340 51341 51241 51496 51485 50990 50982 50988 50853 50894
 51510 50973 51507 51345 51465 50992 51398 51411 51412 51425 51426 50926
 51432 51049 51305 51307 51310 51370 51372 51374 51323 51328 51334 51311
 51449 50850 51349 50921 50839 51354 51502 50865 51119 51121 51223 51225
 51039 51220 51219 51270 51388 51391 51397 51399 51400 51401 51402 51404
 51408 51416 51418 51420 51423 51488 50947 51306 51320 51324 51331 51333
 51336 51392 51406 51470 51435 50858 50859 51044 51029 51037 51040 51149
 51477 51024 50901 51048 51050 51057 51058 50846 50958 51298 51299 50955
 51346 51211 51021 51490 50959 51468 51083 50898 51475 51188 51189 51394
 51405 51160 51350 51467 50840 51511 51456 50961 50845 51202 51208 51443
 51209 51174 51175 51185 51186 51154 51155 51156 51158 51159 51177 51178
 51182 51191 51193 51217 51162 51163 51286 51187 51190 51016 51066 51308
 51179 51280 51281 51173 51165 51166 51169 51170 51356 51390 51395]
Unique items in LABEVENTS with sepsis: 635 items
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:544: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50993 50979 51240 50806 50822 50824
 50826 50828 51003 50819 51007 51218 51071 51074 51075 51079 51087 51090
 51092 50924 50938 50952 50953 50998 51283 50929 51103 51082 51093 51100
 51104 50883 50884 51014 51018 51351 51355 51360 51362 51363 50803 51257
 51284 51292 51294 51151 51259 51347 51148 50856 50879 50880 50922 50964
 50981 50999 50995 51001 50937 50939 50920 51482 51512 50889 50915 50935
 51497 51501 50933 51053 51054 51059 51446 51447 51448 51450 51455 51457
 51458 51213 51196 51078 51097 51236 50925 51010 51479 51352 50903 50904
 50905 50907 50873 50927 50980 51474 51523 51076 51094 51108 50835 50838
 51110 51111 51116 51117 51120 51125 51127 51128 50930 50976 50843 50849
 51118 50836 50841 50842 50866 51288 50967 51269 51026 51032 51038 51461
 50919 51099 51102 50831 51386 51427 51428 51431 51434 51436 51438 51439
 51069 51070 50944 50814 51147 51085 51130 51131 51132 51133 51176 51180
 51181 51194 51245 51300 50917 50914 51002 50986 50978 50968 50969 50874
 50975 50966 50965 50994 50895 50896 51005 51091 51088 51095 50974 50913
 50890 50891 51518 50963 51114 51469 50857 51197 51205 51206 51232 50946
 50949 50950 50951 50844 51134 51028 50871 50876 50918 51344 51419 51429
 51086 51098 50948 50852 51216 51138 51139 51243 51343 51357 51198 51261
 51264 51235 51297 51105 50805 51369 51373 51375 51379 51382 51384 51046
 51444 51077 51515 51385 51015 51383 50997 50881 51067 51068 51080 51081
 51101 51106 51109 51503 51063 51505 50872 51387 51123 51008 51513 51089
 51422 51445 51302 51499 51229 51047 51052 51228 51517 51060 51231 51234
 51424 50854 50855 51460 51441 51440 51453 50906 51150 51036 51051 51073
 51072 51204 51471 51262 51494 51376 51452 51034 51043 51358 51025 51035
 50892 50899 51278 50962 50972 51451 51489 51348 51199 51481 51224 51226
 51227 51290 51442 51084 51136 50957 50928 50829 51263 51291 51276 50830
 51112 51366 51378 51381 51030 51041 51042 51061 51062 51064 51065 51271
 51454 51430 51433 51027 51045 51022 50996 51500 51017 51495 50886 51122
 51124 51289 51140 51272 51273 51368 51365 50932 51377 51380 50945 51459
 50877 50991 50851 51339 51342 50848 51247 50837 50847 51115 51113 51152
 51164 51167 51168 51172 51183 51184 51192 51215 51230 51238 51239 51353
 51303 51309 51313 51314 51315 51317 51319 51321 51325 51326 51332 51335
 51337 51338 51340 51341 51241 51496 51485 50990 50982 50988 50853 50894
 51510 50973 51507 51345 51465 50992 51398 51411 51412 51425 51426 50926
 51432 51049 51305 51307 51310 51370 51372 51374 51323 51328 51334 51311
 51449 50850 51349 50921 50839 51354 51502 50865 51119 51121 51223 51225
 51039 51220 51219 51270 51388 51391 51397 51399 51400 51401 51402 51404
 51408 51416 51418 51420 51423 51488 50947 51306 51320 51324 51331 51333
 51336 51392 51406 51470 51435 50858 50859 51044 51029 51037 51040 51149
 51477 51024 50901 51048 51050 51057 51058 50846 50958 51298 51299 50955
 51346 51211 51021 51490 50959 51468 51083 50898 51475 51188 51189 51394
 51405 51160 51350 51467 50840 51511 51456 50961 50845 51202 51208 51443
 51209 51174 51175 51185 51186 51154 51155 51156 51158 51159 51177 51178
 51182 51191 51193 51217 51162 51163 51286 51187 51190 51016 51066 51308
 51179 51280 51281 51173 51165 51166 51169 51170 51356 51390 51395]
Number of unique patients with sepsis: 4226
Number of output events with sepsis: 374773
Unique Columns in df_output_patient
['ROW_ID', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Number of unique patients with sepsis: 4497
Number of lab events with sepsis: 1118623
Unique Columns in df_lab_patient
['ROW_ID_x', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID_y', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
Number of common patients: 4156
df1_common length: 4156
df2_common length: 4156
Starting Aggregation for Output Events for 4156 patients
Outputevents Aggregation done in 1408.898188829422 seconds
Input dimensions: 4156 patients x 72 hours x 113 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_output_15bin_neg
Starting Aggregation for Lab Events for 4156 patients
Labevents Aggregation done in 1171.5838327407837 seconds
Input dimensions: 4156 patients x 72 hours x 201 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_lab_15bin_neg
aggregate_events took 5320.816099643707
Loaded input_sepsis_lab_15bin.npy
shape: (4156, 72, 201)
Loaded input_sepsis_output_15bin.npy
shape: (4156, 72, 113)
Loaded input_sepsis_lab_15bin_neg.npy
shape: (4156, 72, 201)
Loaded input_sepsis_output_15bin_neg.npy
shape: (4156, 72, 113)
combined length: 4156
combined_neg length: 4156
data_train shape: (6649, 72, 314)
labels_train shape: (6649, 1)
data_test shape: (1663, 72, 314)
labels_test shape: (1663, 1)
Aggregating events for sepsis, with 20 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with sepsis: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[50809 50818 50820 50821 50822 50800 50802 50804 50808 51221 50882 50893
 50902 50912 50960 50970 50983 51006 51222 51237 51248 51249 51250 51265
 51274 51275 51277 51279 51301 50868 50931 50971 50817 50861 50862 50863
 50867 50878 50885 50910 50911 50954 50956 51003 51463 51464 51466 51476
 51478 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516
 51519 50903 50904 50905 50907 50993 51000 50810 50811 50812 50824 50828
 50806 51134 51137 51143 51144 51146 51200 51233 51244 51246 51251 51252
 51254 51255 51256 51257 51267 51268 51294 50967 50908 50883 50884 51283
 51266 50813 50816 50819 50826 50827 51069 51070 51082 51087 50852 50924
 50925 50952 50953 50998 51010 50940 50942 50943 50866 51099 51102 51104
 50927 51260 51287 51292 51296 50979 50825 51002 50986 51214 51071 51074
 51075 51079 51090 51092 51216 50995 50887 50801 50823 50909 51009 50930
 50976 51046 51053 51054 51059 51446 51448 51450 51455 51457 51458 51288
 51482 50906 51512 51151 50920 51462 50854 50855 50889 50879 50880 50999
 50935 51007 50957 50964 51078 51097 51100 51196 50835 50836 50838 50841
 50842 50843 50849 51110 51114 51116 51120 51125 51127 51128 51213 50803
 50857 51014 51018 51351 51355 51360 51362 51363 51479 51076 51093 50917
 51469 51474 51240 51278 50919 50815 50895 50896 50937 50941 50974 50994
 51005 51080 51081 51094 51101 51106 51108 51109 50922 51264 50929 51103
 51086 51098 50975 51095 51105 50918 50948 50949 50950 50951 51481 50814
 51284 51501 51513 51008 51523 51138 51139 51297 50856 50981 51427 51428
 51431 51436 51438 51439 51387 51347 51352 50963 51218 51001 50933 51147
 50978 51518 51444 51373 51375 51379 51382 51383 51384 51117 51118 51269
 50990 51343 50891 50873 50966 50968 51197 50945 51145 50845 50864 50900
 50939 50969 51358 50938 50944 51429 51442 51447 51453 50831 51047 51052
 51441 50805 51032 51434 50890 51259 51152 51160 51164 51167 51168 51172
 51176 51180 51183 51184 51192 51194 51215 51230 51238 51239 51262 51203
 51206 51209 51210 51235 51243 51298 51299 50962 50972 51115 51112 51016
 51261 50872 50965 51123 51025 51026 51034 51035 51043 51344 51130 51131
 51132 51133 51181 51245 51300 50874 50876 51357 51370 51372 51374 51247
 51232 51497 50898 51419 51148 51199 51505 51499 51067 51068 51231 51077
 50871 51424 51345 51229 50914 50899 50829 50850 51122 51385 51084 51088
 51027 51030 51039 51041 51042 50877 51040 51045 51072 51073 51140 50886
 51465 51517 50946 50980 50901 51091 51386 51432 51263 51445 51085 51089
 50928 51489 51291 51388 51398 51400 51402 51404 51411 51412 51420 51423
 51425 51426 50830 50832 51460 51507 51044 51028 51440 51212 50892 51061
 51062 51063 51064 51065 51503 50915 50973 51510 51408 51418 50997 51422
 51015 51494 50921 50926 50958 51051 51060 51376 51515 51467 51198 50913
 51224 51226 51227 51285 51048 51050 51057 51058 51302 51369 51234 51303
 51313 51315 51317 51319 51325 51326 51335 51337 51340 51341 51342 51017
 51111 51452 51149 51377 51228 51270 51271 51272 51273 51471 51511 51359
 51241 51353 51339 51276 51470 51202 51461 51205 50977 50991 51496 51223
 51225 51258 51399 51407 51416 51354 51356 51348 51150 50988 51454 51397
 50932 50996 51204 50853 51350 50992 51162 51163 51174 51175 50865 50881
 51305 51306 51307 51309 51310 51314 51320 51321 51323 51324 51328 51331
 51332 51333 51334 51336 51338 51495 51219 51236 51529 51207 51049 51393
 51413 51038 50961 51396 51414 51208 51480 51389 51391 51401 51403]
Unique items in LABEVENTS with sepsis: 563 items
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
[50809 50818 50820 50821 50822 50800 50802 50804 50808 51221 50882 50893
 50902 50912 50960 50970 50983 51006 51222 51237 51248 51249 51250 51265
 51274 51275 51277 51279 51301 50868 50931 50971 50817 50861 50862 50863
 50867 50878 50885 50910 50911 50954 50956 51003 51463 51464 51466 51476
 51478 51484 51486 51487 51491 51492 51493 51498 51506 51508 51514 51516
 51519 50903 50904 50905 50907 50993 51000 50810 50811 50812 50824 50828
 50806 51134 51137 51143 51144 51146 51200 51233 51244 51246 51251 51252
 51254 51255 51256 51257 51267 51268 51294 50967 50908 50883 50884 51283
 51266 50813 50816 50819 50826 50827 51069 51070 51082 51087 50852 50924
 50925 50952 50953 50998 51010 50940 50942 50943 50866 51099 51102 51104
 50927 51260 51287 51292 51296 50979 50825 51002 50986 51214 51071 51074
 51075 51079 51090 51092 51216 50995 50887 50801 50823 50909 51009 50930
 50976 51046 51053 51054 51059 51446 51448 51450 51455 51457 51458 51288
 51482 50906 51512 51151 50920 51462 50854 50855 50889 50879 50880 50999
 50935 51007 50957 50964 51078 51097 51100 51196 50835 50836 50838 50841
 50842 50843 50849 51110 51114 51116 51120 51125 51127 51128 51213 50803
 50857 51014 51018 51351 51355 51360 51362 51363 51479 51076 51093 50917
 51469 51474 51240 51278 50919 50815 50895 50896 50937 50941 50974 50994
 51005 51080 51081 51094 51101 51106 51108 51109 50922 51264 50929 51103
 51086 51098 50975 51095 51105 50918 50948 50949 50950 50951 51481 50814
 51284 51501 51513 51008 51523 51138 51139 51297 50856 50981 51427 51428
 51431 51436 51438 51439 51387 51347 51352 50963 51218 51001 50933 51147
 50978 51518 51444 51373 51375 51379 51382 51383 51384 51117 51118 51269
 50990 51343 50891 50873 50966 50968 51197 50945 51145 50845 50864 50900
 50939 50969 51358 50938 50944 51429 51442 51447 51453 50831 51047 51052
 51441 50805 51032 51434 50890 51259 51152 51160 51164 51167 51168 51172
 51176 51180 51183 51184 51192 51194 51215 51230 51238 51239 51262 51203
 51206 51209 51210 51235 51243 51298 51299 50962 50972 51115 51112 51016
 51261 50872 50965 51123 51025 51026 51034 51035 51043 51344 51130 51131
 51132 51133 51181 51245 51300 50874 50876 51357 51370 51372 51374 51247
 51232 51497 50898 51419 51148 51199 51505 51499 51067 51068 51231 51077
 50871 51424 51345 51229 50914 50899 50829 50850 51122 51385 51084 51088
 51027 51030 51039 51041 51042 50877 51040 51045 51072 51073 51140 50886
 51465 51517 50946 50980 50901 51091 51386 51432 51263 51445 51085 51089
 50928 51489 51291 51388 51398 51400 51402 51404 51411 51412 51420 51423
 51425 51426 50830 50832 51460 51507 51044 51028 51440 51212 50892 51061
 51062 51063 51064 51065 51503 50915 50973 51510 51408 51418 50997 51422
 51015 51494 50921 50926 50958 51051 51060 51376 51515 51467 51198 50913
 51224 51226 51227 51285 51048 51050 51057 51058 51302 51369 51234 51303
 51313 51315 51317 51319 51325 51326 51335 51337 51340 51341 51342 51017
 51111 51452 51149 51377 51228 51270 51271 51272 51273 51471 51511 51359
 51241 51353 51339 51276 51470 51202 51461 51205 50977 50991 51496 51223
 51225 51258 51399 51407 51416 51354 51356 51348 51150 50988 51454 51397
 50932 50996 51204 50853 51350 50992 51162 51163 51174 51175 50865 50881
 51305 51306 51307 51309 51310 51314 51320 51321 51323 51324 51328 51331
 51332 51333 51334 51336 51338 51495 51219 51236 51529 51207 51049 51393
 51413 51038 50961 51396 51414 51208 51480 51389 51391 51401 51403]
Number of unique patients with sepsis: 4226
Number of output events with sepsis: 374773
Number of unique patients with sepsis: 4497
Number of lab events with sepsis: 1118623
For outputevents:
100 items were included from 1153 unique items.
For labevents
185 items were included from 563 unique items.
Number of common patients: 4156
df1_common length: 4156
df2_common length: 4156
Starting Aggregation for Output Events for 4156 patients
Outputevents Aggregation done in 1213.6128301620483 seconds
Input dimensions: 4156 patients x 72 hours x 100 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_output_20bin
Starting Aggregation for Lab Events for 4156 patients
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/utils.py:137: DtypeWarning: Columns (5,7,22) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
Labevents Aggregation done in 1021.7999360561371 seconds
Input dimensions: 4156 patients x 72 hours x 185 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_lab_20bin
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with sepsis: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50993 50979 51240 50806 50822 50824
 50826 50828 51003 50819 51007 51218 51071 51074 51075 51079 51087 51090
 51092 50924 50938 50952 50953 50998 51283 50929 51103 51082 51093 51100
 51104 50883 50884 51014 51018 51351 51355 51360 51362 51363 50803 51257
 51284 51292 51294 51151 51259 51347 51148 50856 50879 50880 50922 50964
 50981 50999 50995 51001 50937 50939 50920 51482 51512 50889 50915 50935
 51497 51501 50933 51053 51054 51059 51446 51447 51448 51450 51455 51457
 51458 51213 51196 51078 51097 51236 50925 51010 51479 51352 50903 50904
 50905 50907 50873 50927 50980 51474 51523 51076 51094 51108 50835 50838
 51110 51111 51116 51117 51120 51125 51127 51128 50930 50976 50843 50849
 51118 50836 50841 50842 50866 51288 50967 51269 51026 51032 51038 51461
 50919 51099 51102 50831 51386 51427 51428 51431 51434 51436 51438 51439
 51069 51070 50944 50814 51147 51085 51130 51131 51132 51133 51176 51180
 51181 51194 51245 51300 50917 50914 51002 50986 50978 50968 50969 50874
 50975 50966 50965 50994 50895 50896 51005 51091 51088 51095 50974 50913
 50890 50891 51518 50963 51114 51469 50857 51197 51205 51206 51232 50946
 50949 50950 50951 50844 51134 51028 50871 50876 50918 51344 51419 51429
 51086 51098 50948 50852 51216 51138 51139 51243 51343 51357 51198 51261
 51264 51235 51297 51105 50805 51369 51373 51375 51379 51382 51384 51046
 51444 51077 51515 51385 51015 51383 50997 50881 51067 51068 51080 51081
 51101 51106 51109 51503 51063 51505 50872 51387 51123 51008 51513 51089
 51422 51445 51302 51499 51229 51047 51052 51228 51517 51060 51231 51234
 51424 50854 50855 51460 51441 51440 51453 50906 51150 51036 51051 51073
 51072 51204 51471 51262 51494 51376 51452 51034 51043 51358 51025 51035
 50892 50899 51278 50962 50972 51451 51489 51348 51199 51481 51224 51226
 51227 51290 51442 51084 51136 50957 50928 50829 51263 51291 51276 50830
 51112 51366 51378 51381 51030 51041 51042 51061 51062 51064 51065 51271
 51454 51430 51433 51027 51045 51022 50996 51500 51017 51495 50886 51122
 51124 51289 51140 51272 51273 51368 51365 50932 51377 51380 50945 51459
 50877 50991 50851 51339 51342 50848 51247 50837 50847 51115 51113 51152
 51164 51167 51168 51172 51183 51184 51192 51215 51230 51238 51239 51353
 51303 51309 51313 51314 51315 51317 51319 51321 51325 51326 51332 51335
 51337 51338 51340 51341 51241 51496 51485 50990 50982 50988 50853 50894
 51510 50973 51507 51345 51465 50992 51398 51411 51412 51425 51426 50926
 51432 51049 51305 51307 51310 51370 51372 51374 51323 51328 51334 51311
 51449 50850 51349 50921 50839 51354 51502 50865 51119 51121 51223 51225
 51039 51220 51219 51270 51388 51391 51397 51399 51400 51401 51402 51404
 51408 51416 51418 51420 51423 51488 50947 51306 51320 51324 51331 51333
 51336 51392 51406 51470 51435 50858 50859 51044 51029 51037 51040 51149
 51477 51024 50901 51048 51050 51057 51058 50846 50958 51298 51299 50955
 51346 51211 51021 51490 50959 51468 51083 50898 51475 51188 51189 51394
 51405 51160 51350 51467 50840 51511 51456 50961 50845 51202 51208 51443
 51209 51174 51175 51185 51186 51154 51155 51156 51158 51159 51177 51178
 51182 51191 51193 51217 51162 51163 51286 51187 51190 51016 51066 51308
 51179 51280 51281 51173 51165 51166 51169 51170 51356 51390 51395]
Unique items in LABEVENTS with sepsis: 635 items
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:544: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50993 50979 51240 50806 50822 50824
 50826 50828 51003 50819 51007 51218 51071 51074 51075 51079 51087 51090
 51092 50924 50938 50952 50953 50998 51283 50929 51103 51082 51093 51100
 51104 50883 50884 51014 51018 51351 51355 51360 51362 51363 50803 51257
 51284 51292 51294 51151 51259 51347 51148 50856 50879 50880 50922 50964
 50981 50999 50995 51001 50937 50939 50920 51482 51512 50889 50915 50935
 51497 51501 50933 51053 51054 51059 51446 51447 51448 51450 51455 51457
 51458 51213 51196 51078 51097 51236 50925 51010 51479 51352 50903 50904
 50905 50907 50873 50927 50980 51474 51523 51076 51094 51108 50835 50838
 51110 51111 51116 51117 51120 51125 51127 51128 50930 50976 50843 50849
 51118 50836 50841 50842 50866 51288 50967 51269 51026 51032 51038 51461
 50919 51099 51102 50831 51386 51427 51428 51431 51434 51436 51438 51439
 51069 51070 50944 50814 51147 51085 51130 51131 51132 51133 51176 51180
 51181 51194 51245 51300 50917 50914 51002 50986 50978 50968 50969 50874
 50975 50966 50965 50994 50895 50896 51005 51091 51088 51095 50974 50913
 50890 50891 51518 50963 51114 51469 50857 51197 51205 51206 51232 50946
 50949 50950 50951 50844 51134 51028 50871 50876 50918 51344 51419 51429
 51086 51098 50948 50852 51216 51138 51139 51243 51343 51357 51198 51261
 51264 51235 51297 51105 50805 51369 51373 51375 51379 51382 51384 51046
 51444 51077 51515 51385 51015 51383 50997 50881 51067 51068 51080 51081
 51101 51106 51109 51503 51063 51505 50872 51387 51123 51008 51513 51089
 51422 51445 51302 51499 51229 51047 51052 51228 51517 51060 51231 51234
 51424 50854 50855 51460 51441 51440 51453 50906 51150 51036 51051 51073
 51072 51204 51471 51262 51494 51376 51452 51034 51043 51358 51025 51035
 50892 50899 51278 50962 50972 51451 51489 51348 51199 51481 51224 51226
 51227 51290 51442 51084 51136 50957 50928 50829 51263 51291 51276 50830
 51112 51366 51378 51381 51030 51041 51042 51061 51062 51064 51065 51271
 51454 51430 51433 51027 51045 51022 50996 51500 51017 51495 50886 51122
 51124 51289 51140 51272 51273 51368 51365 50932 51377 51380 50945 51459
 50877 50991 50851 51339 51342 50848 51247 50837 50847 51115 51113 51152
 51164 51167 51168 51172 51183 51184 51192 51215 51230 51238 51239 51353
 51303 51309 51313 51314 51315 51317 51319 51321 51325 51326 51332 51335
 51337 51338 51340 51341 51241 51496 51485 50990 50982 50988 50853 50894
 51510 50973 51507 51345 51465 50992 51398 51411 51412 51425 51426 50926
 51432 51049 51305 51307 51310 51370 51372 51374 51323 51328 51334 51311
 51449 50850 51349 50921 50839 51354 51502 50865 51119 51121 51223 51225
 51039 51220 51219 51270 51388 51391 51397 51399 51400 51401 51402 51404
 51408 51416 51418 51420 51423 51488 50947 51306 51320 51324 51331 51333
 51336 51392 51406 51470 51435 50858 50859 51044 51029 51037 51040 51149
 51477 51024 50901 51048 51050 51057 51058 50846 50958 51298 51299 50955
 51346 51211 51021 51490 50959 51468 51083 50898 51475 51188 51189 51394
 51405 51160 51350 51467 50840 51511 51456 50961 50845 51202 51208 51443
 51209 51174 51175 51185 51186 51154 51155 51156 51158 51159 51177 51178
 51182 51191 51193 51217 51162 51163 51286 51187 51190 51016 51066 51308
 51179 51280 51281 51173 51165 51166 51169 51170 51356 51390 51395]
Number of unique patients with sepsis: 4226
Number of output events with sepsis: 374773
Unique Columns in df_output_patient
['ROW_ID', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Number of unique patients with sepsis: 4497
Number of lab events with sepsis: 1118623
Unique Columns in df_lab_patient
['ROW_ID_x', 'SUBJECT_ID', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'ROW_ID_x', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID_y', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
Number of common patients: 4156
df1_common length: 4156
df2_common length: 4156
Starting Aggregation for Output Events for 4156 patients
Outputevents Aggregation done in 1188.091194152832 seconds
Input dimensions: 4156 patients x 72 hours x 100 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_output_20bin_neg
Starting Aggregation for Lab Events for 4156 patients
Labevents Aggregation done in 1021.8902840614319 seconds
Input dimensions: 4156 patients x 72 hours x 185 items
Data saved to /home/paperspace/Desktop/Early-Warning-System/Preprocessing/../data/input/input_sepsis_lab_20bin_neg
aggregate_events took 4597.051303386688
Loaded input_sepsis_lab_20bin.npy
shape: (4156, 72, 185)
Loaded input_sepsis_output_20bin.npy
shape: (4156, 72, 100)
Loaded input_sepsis_lab_20bin_neg.npy
shape: (4156, 72, 185)
Loaded input_sepsis_output_20bin_neg.npy
shape: (4156, 72, 100)
combined length: 4156
combined_neg length: 4156
data_train shape: (6649, 72, 285)
labels_train shape: (6649, 1)
data_test shape: (1663, 72, 285)
labels_test shape: (1663, 1)
Traceback (most recent call last):
  File "/home/paperspace/.local/lib/python3.9/site-packages/torch/serialization.py", line 379, in save
    _save(obj, opened_zipfil