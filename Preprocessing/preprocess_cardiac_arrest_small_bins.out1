nohup: ignoring input
/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py:437: FutureWarning: Passing 'suffixes' which cause duplicate columns {'ROW_ID_y'} in the result is deprecated and will raise a MergeError in a future version.
  df_lab_patient = pd.merge(df_patients, df_lab_icu_specific, on='SUBJECT_ID', how='inner')
Aggregating events for cardiac arrest, with 2 bins
Unique Columns in df_output_event
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ICUSTAY_ID', 'CHARTTIME', 'ITEMID', 'VALUE', 'VALUEUOM', 'CGID', 'INTIME', 'OUTTIME', 'ROW_ID_y', 'DBSOURCE', 'LINKSTO']
Unique Columns in df_lab_icu_specific
['ROW_ID_x', 'SUBJECT_ID', 'HADM_ID', 'ITEMID', 'CHARTTIME', 'VALUE', 'VALUENUM', 'VALUEUOM', 'ROW_ID_y', 'ICUSTAY_ID', 'DBSOURCE', 'FIRST_CAREUNIT', 'LAST_CAREUNIT', 'FIRST_WARDID', 'LAST_WARDID', 'INTIME', 'OUTTIME', 'LOS', 'ROW_ID', 'LABEL', 'FLUID', 'CATEGORY', 'LOINC_CODE']
[ 40055  40052  40059 ... 226618 226557 226621]
Unique items in OUTPUTEVENTS with cardiac arrest: 1153 items
[ 40055  40052  40059 ... 226618 226557 226621]
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Unique items in LABEVENTS with cardiac arrest: 511 items
[51274 51275 51277 51279 51301 50868 50882 50893 50902 50912 50931 50960
 50970 50971 50983 51006 51221 51222 51248 51249 51250 51265 50910 50911
 51237 51462 51463 51464 51466 51476 51478 51484 51486 51487 51491 51492
 51493 51498 51506 51508 51514 51516 51519 50861 50863 50878 50885 50908
 50954 50800 50801 50802 50804 50809 50812 50813 50816 50818 50820 50821
 50823 50825 50810 50811 50815 50817 50808 50827 51144 51146 51200 51244
 51254 51256 51266 50862 51000 51214 50867 50956 51009 51137 51145 51233
 51246 51252 51260 51267 51268 51296 50909 51143 51251 51255 51287 50940
 50941 50942 50943 50864 50887 50900 50819 50828 50883 50884 51294 51259
 51014 51018 51347 51351 51355 51360 51362 51363 50826 50929 51283 51003
 51082 51087 51093 51100 51104 50822 50903 50904 50905 50907 50924 50952
 50953 50998 50873 50927 51240 50806 50824 51078 50980 51097 51474 50964
 50935 51479 51501 51257 51523 51076 51094 51108 50933 50889 51288 50967
 51292 50803 51269 50993 50995 51131 51133 51180 51245 51300 51512 50979
 50968 50969 51007 51344 51357 50814 51343 51352 51002 50997 51503 51151
 51213 51063 50944 50914 51469 51505 50963 50872 51218 51134 51387 51427
 51431 51436 51438 51439 51147 51099 51102 51419 51428 51429 50836 51289
 50856 50879 50880 50922 50981 50999 50919 51008 50945 51278 51359 50994
 50925 51010 50890 50891 50986 51091 50917 50866 51482 51116 51117 51120
 51125 51127 51128 50920 50852 50975 50976 50930 51150 51284 51053 51054
 51059 51446 51447 51448 51450 51455 51457 51458 51497 51196 51001 50937
 50949 50950 50951 51518 51071 51074 51075 51079 51090 51092 50871 50874
 50876 50895 50896 50938 51005 50946 50877 51434 51118 50835 51112 51114
 51089 51216 51030 51041 51042 51077 51088 51095 51061 51062 51064 51065
 51271 51015 51017 50805 50948 51098 50965 50939 50974 50918 51467 50854
 50855 51276 51103 51069 51070 51232 50915 51499 50837 50838 50841 50842
 50843 50847 50848 50849 51110 51123 51197 51115 51130 51132 51176 51181
 51194 51148 51046 51453 50829 50831 51026 51043 51513 51353 51105 51261
 50892 50857 51422 51502 50906 51510 51481 51398 51404 51411 51264 50966
 51441 51442 51444 50928 51198 51206 51465 51047 51243 51205 51297 51035
 51452 51231 51247 51496 51345 51489 50926 50958 51051 51052 51445 51149
 51235 51236 51111 51122 50973 51424 51425 51426 51204 51228 50913 51027
 51028 51029 51036 51037 51040 51138 51139 51263 50990 51229 51370 51372
 51373 51374 51375 51376 51379 51382 51383 51384 51140 50932 51219 50955
 51086 50886 51067 51068 50991 51471 50996 50988 50989 50899 51299 51298
 51440 51385 51388 51400 51402 51406 51412 51420 51423 51049 51060 51454
 50839 51460 50957 51495 51456 51358 51085 51303 51305 51306 51307 51309
 51310 51313 51314 51315 51319 51320 51321 51323 51324 51325 51326 51328
 51331 51332 51333 51334 51336 51337 51338 51339 51340 51341 51342 51154
 51156 51158 51159 51177 51178 51183 51230 51234 51367 51084 51223 51224
 51225 51226 51227 51517 51511 51515 50853 51188 51119 51273 51025 51034
 50992 50978 51507 50865 51386 51430 51286 51433 51377 51152 51164 51168
 51172 51184 51215 51238 51239 51317 51335]
Number of unique patients with cardiac arrest: 1216
Number of output events with cardiac arrest: 129946
Number of unique patients with cardiac arrest: 1274
Number of lab events with cardiac arrest: 389597
For outputevents:
Traceback (most recent call last):
  File "/home/paperspace/Desktop/Early-Warning-System/Preprocessing/main.py", line 55, in <module>
    aggregate_bins("cardiac arrest", NUMS_BIN, BATCH_SIZE, RANDOM_SEED)
  File "/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py", line 936, in aggregate_bins
    df_output_unique, df_lab_unique = aggregate_events_output_lab_bin(keyword, num)
  File "/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py", line 444, in aggregate_events_output_lab_bin
    df_output_window, items_excluded_output = assign_windows(df_output_patient, df_output_unique, num_bins)
  File "/home/paperspace/Desktop/Early-Warning-System/Preprocessing/preprocess.py", line 918, in assign_windows
    quantile_bin, bins = pd.qcut(item_df_numeric, q=num_bins, retbins=True, labels=False, duplicates='drop')
  File "/home/paperspace/.local/lib/python3.9/site-packages/pandas/core/reshape/tile.py", line 376, in qcut
    bins = np.quantile(x_np, quantiles)
  File "<__array_function__ internals>", line 180, in quantile
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/lib/function_base.py", line 4412, in quantile
    return _quantile_unchecked(
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/lib/function_base.py", line 4424, in _quantile_unchecked
    r, k = _ureduce(a,
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/lib/function_base.py", line 3725, in _ureduce
    r = func(a, **kwargs)
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/lib/function_base.py", line 4593, in _quantile_ureduce_func
    result = _quantile(arr,
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/lib/function_base.py", line 4699, in _quantile
    take(arr, indices=-1, axis=DATA_AXIS)
  File "<__array_function__ internals>", line 180, in take
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/core/fromnumeric.py", line 190, in take
    return _wrapfunc(a, 'take', indices, axis=axis, out=out, mode=mode)
  File "/home/paperspace/.local/lib/python3.9/site-packages/numpy/core/fromnumeric.py", line 57, in _wrapfunc
    return bound(*args, **kwds)
IndexError: cannot do a non-empty take from an empty axes.
